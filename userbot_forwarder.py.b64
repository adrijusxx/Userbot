-----BEGIN CERTIFICATE-----
aW1wb3J0IG9zDQppbXBvcnQgYXN5bmNpbw0KaW1wb3J0IGxvZ2dpbmcNCmltcG9y
dCByZQ0KaW1wb3J0IHNpZ25hbA0KaW1wb3J0IHN5cw0KaW1wb3J0IGFyZ3BhcnNl
DQpmcm9tIHRlbGV0aG9uIGltcG9ydCBUZWxlZ3JhbUNsaWVudCwgZXZlbnRzDQpm
cm9tIHRlbGV0aG9uLmVycm9ycyBpbXBvcnQgU2Vzc2lvblBhc3N3b3JkTmVlZGVk
RXJyb3IsIFBob25lQ29kZUludmFsaWRFcnJvciwgUGhvbmVOdW1iZXJJbnZhbGlk
RXJyb3INCmZyb20gdHlwaW5nIGltcG9ydCBPcHRpb25hbA0KaW1wb3J0IHRpbWUN
CmltcG9ydCBqc29uDQpmcm9tIGRhdGV0aW1lIGltcG9ydCBkYXRldGltZSwgZGF0
ZQ0KDQojIENvbmZpZ3VyZSBsb2dnaW5nDQpsb2dnaW5nLmJhc2ljQ29uZmlnKA0K
ICAgIGxldmVsPWxvZ2dpbmcuSU5GTywNCiAgICBmb3JtYXQ9JyUoYXNjdGltZSlz
IC0gJShsZXZlbG5hbWUpcyAtICUobWVzc2FnZSlzJywNCiAgICBoYW5kbGVycz1b
DQogICAgICAgIGxvZ2dpbmcuRmlsZUhhbmRsZXIoJ3VzZXJib3RfZm9yd2FyZGVy
LmxvZycpLA0KICAgICAgICBsb2dnaW5nLlN0cmVhbUhhbmRsZXIoc3lzLnN0ZG91
dCkNCiAgICBdDQopDQpsb2dnZXIgPSBsb2dnaW5nLmdldExvZ2dlcihfX25hbWVf
XykNCg0KIyAtLS0gQ29uZmlndXJhdGlvbiBmb3IgVXNlcmJvdCAtLS0NCkFQSV9J
RCA9IGludChvcy5lbnZpcm9uLmdldCgnVEVMRUdSQU1fQVBJX0lEJywgJzI3NTY3
NTg3JykpDQpBUElfSEFTSCA9IG9zLmVudmlyb24uZ2V0KCdURUxFR1JBTV9BUElf
SEFTSCcsICdkZDIwZDJlNTc4MzdhZGNjZjlkYTdkN2VlNDljMTNkNicpDQpCT1Rf
VVNFUk5BTUUgPSBvcy5lbnZpcm9uLmdldCgnVEVMRUdSQU1fQk9UX1VTRVJOQU1F
JywgJ0FmdGVyaG91cnNGV0xfQm90JykNCg0KIyBEdXBsaWNhdGUgbWVzc2FnZSBo
YW5kbGluZyBjb25maWd1cmF0aW9uDQpEVVBMSUNBVEVfSUdOT1JFX0RVUkFUSU9O
ID0gaW50KG9zLmVudmlyb24uZ2V0KCdEVVBMSUNBVEVfSUdOT1JFX0RVUkFUSU9O
JywgJzM2MDAnKSkgICMgRGVmYXVsdDogMSBob3VyIGluIHNlY29uZHMNCkRVUExJ
Q0FURV9DSEVDS19FTkFCTEVEID0gb3MuZW52aXJvbi5nZXQoJ0RVUExJQ0FURV9D
SEVDS19FTkFCTEVEJywgJ3RydWUnKS5sb3dlcigpID09ICd0cnVlJw0KDQpTRVNT
SU9OX05BTUUgPSAnZHJpdmVyX2ZvcndhcmRpbmdfc2Vzc2lvbicNClNFU1NJT05f
UEFUSCA9IG9zLnBhdGguam9pbihvcy5wYXRoLmRpcm5hbWUob3MucGF0aC5hYnNw
YXRoKF9fZmlsZV9fKSksIGYne1NFU1NJT05fTkFNRX0uc2Vzc2lvbicpDQoNCiMg
R2xvYmFsIHZhcmlhYmxlcyBmb3IgZ3JhY2VmdWwgc2h1dGRvd24NCmNsaWVudCA9
IE5vbmUNCnNodXRkb3duX2V2ZW50ID0gYXN5bmNpby5FdmVudCgpDQoNCmNsYXNz
IFVzZXJib3RGb3J3YXJkZXI6DQogICAgZGVmIF9faW5pdF9fKHNlbGYpOg0KICAg
ICAgICBzZWxmLmNsaWVudCA9IFRlbGVncmFtQ2xpZW50KFNFU1NJT05fTkFNRSwg
QVBJX0lELCBBUElfSEFTSCkNCiAgICAgICAgc2VsZi5ib3RfZW50aXR5ID0gTm9u
ZQ0KICAgICAgICBzZWxmLnJldHJ5X2NvdW50ID0gMA0KICAgICAgICBzZWxmLm1h
eF9yZXRyaWVzID0gNQ0KICAgICAgICBzZWxmLnJldHJ5X2RlbGF5ID0gMzAgICMg
c2Vjb25kcw0KICAgICAgICANCiAgICAgICAgIyBEYWlseSBtZXNzYWdlIHRyYWNr
aW5nDQogICAgICAgIHNlbGYuZGFpbHlfbWVzc2FnZXNfZmlsZSA9IG9zLnBhdGgu
am9pbihvcy5wYXRoLmRpcm5hbWUob3MucGF0aC5hYnNwYXRoKF9fZmlsZV9fKSks
ICdkYWlseV9tZXNzYWdlcy5qc29uJykNCiAgICAgICAgc2VsZi5mb3J3YXJkZWRf
dG9kYXkgPSBzZWxmLmxvYWRfZGFpbHlfbWVzc2FnZXMoKQ0KICAgICAgICANCiAg
ICAgICAgIyBNZXNzYWdlIHRyYWNraW5nIGZvciBkdXBsaWNhdGUgaGFuZGxpbmcN
CiAgICAgICAgc2VsZi5tZXNzYWdlX3RyYWNraW5nX2ZpbGUgPSBvcy5wYXRoLmpv
aW4ob3MucGF0aC5kaXJuYW1lKG9zLnBhdGguYWJzcGF0aChfX2ZpbGVfXykpLCAn
bWVzc2FnZV90cmFja2luZy5qc29uJykNCiAgICAgICAgc2VsZi5tZXNzYWdlX3Ry
YWNraW5nID0gc2VsZi5sb2FkX21lc3NhZ2VfdHJhY2tpbmcoKQ0KICAgICAgICAN
CiAgICAgICAgIyBDbGVhbiB1cCBvbGQgdHJhY2tpbmcgZGF0YSBvbiBzdGFydHVw
DQogICAgICAgIHNlbGYuY2xlYW51cF9vbGRfdHJhY2tpbmdfZGF0YSgpDQogICAg
ICAgIA0KICAgIGRlZiBsb2FkX2RhaWx5X21lc3NhZ2VzKHNlbGYpIC0+IGRpY3Q6
DQogICAgICAgICIiIkxvYWQgdG9kYXkncyBmb3J3YXJkZWQgbWVzc2FnZXMgZnJv
bSBmaWxlIiIiDQogICAgICAgIHRvZGF5ID0gc3RyKGRhdGUudG9kYXkoKSkNCiAg
ICAgICAgdHJ5Og0KICAgICAgICAgICAgaWYgb3MucGF0aC5leGlzdHMoc2VsZi5k
YWlseV9tZXNzYWdlc19maWxlKToNCiAgICAgICAgICAgICAgICB3aXRoIG9wZW4o
c2VsZi5kYWlseV9tZXNzYWdlc19maWxlLCAncicpIGFzIGY6DQogICAgICAgICAg
ICAgICAgICAgIGRhdGEgPSBqc29uLmxvYWQoZikNCiAgICAgICAgICAgICAgICAg
ICAgIyBSZXR1cm4gdG9kYXkncyBkYXRhLCBvciBlbXB0eSBkaWN0IGlmIGl0J3Mg
YSBuZXcgZGF5DQogICAgICAgICAgICAgICAgICAgIGlmIGRhdGEuZ2V0KCdkYXRl
JykgPT0gdG9kYXk6DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGF0
YS5nZXQoJ2ZvcndhcmRlZF91c2VycycsIHt9KQ0KICAgICAgICAgICAgICAgICAg
ICBlbHNlOg0KICAgICAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLmluZm8oZiJO
ZXcgZGF5IGRldGVjdGVkLiBSZXNldHRpbmcgZm9yd2FyZGVkIG1lc3NhZ2VzIHRy
YWNraW5nLiIpDQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge30NCiAg
ICAgICAgICAgIHJldHVybiB7fQ0KICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFz
IGU6DQogICAgICAgICAgICBsb2dnZXIuZXJyb3IoZiJFcnJvciBsb2FkaW5nIGRh
aWx5IG1lc3NhZ2VzIGZpbGU6IHtlfSIpDQogICAgICAgICAgICByZXR1cm4ge30N
CiAgICANCiAgICBkZWYgc2F2ZV9kYWlseV9tZXNzYWdlcyhzZWxmKToNCiAgICAg
ICAgIiIiU2F2ZSB0b2RheSdzIGZvcndhcmRlZCBtZXNzYWdlcyB0byBmaWxlIiIi
DQogICAgICAgIHRvZGF5ID0gc3RyKGRhdGUudG9kYXkoKSkNCiAgICAgICAgZGF0
YSA9IHsNCiAgICAgICAgICAgICdkYXRlJzogdG9kYXksDQogICAgICAgICAgICAn
Zm9yd2FyZGVkX3VzZXJzJzogc2VsZi5mb3J3YXJkZWRfdG9kYXkNCiAgICAgICAg
fQ0KICAgICAgICB0cnk6DQogICAgICAgICAgICB3aXRoIG9wZW4oc2VsZi5kYWls
eV9tZXNzYWdlc19maWxlLCAndycpIGFzIGY6DQogICAgICAgICAgICAgICAganNv
bi5kdW1wKGRhdGEsIGYsIGluZGVudD0yKQ0KICAgICAgICBleGNlcHQgRXhjZXB0
aW9uIGFzIGU6DQogICAgICAgICAgICBsb2dnZXIuZXJyb3IoZiJFcnJvciBzYXZp
bmcgZGFpbHkgbWVzc2FnZXMgZmlsZToge2V9IikNCiAgICANCiAgICBkZWYgbG9h
ZF9tZXNzYWdlX3RyYWNraW5nKHNlbGYpIC0+IGRpY3Q6DQogICAgICAgICIiIkxv
YWQgbWVzc2FnZSB0cmFja2luZyBkYXRhIGZyb20gZmlsZSIiIg0KICAgICAgICB0
cnk6DQogICAgICAgICAgICBpZiBvcy5wYXRoLmV4aXN0cyhzZWxmLm1lc3NhZ2Vf
dHJhY2tpbmdfZmlsZSk6DQogICAgICAgICAgICAgICAgd2l0aCBvcGVuKHNlbGYu
bWVzc2FnZV90cmFja2luZ19maWxlLCAncicpIGFzIGY6DQogICAgICAgICAgICAg
ICAgICAgIGRhdGEgPSBqc29uLmxvYWQoZikNCiAgICAgICAgICAgICAgICAgICAg
cmV0dXJuIGRhdGENCiAgICAgICAgICAgIHJldHVybiB7J2lnbm9yZWQnOiB7fSwg
J2NvbGxlY3RlZCc6IHt9fQ0KICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6
DQogICAgICAgICAgICBsb2dnZXIuZXJyb3IoZiJFcnJvciBsb2FkaW5nIG1lc3Nh
Z2UgdHJhY2tpbmcgZmlsZToge2V9IikNCiAgICAgICAgICAgIHJldHVybiB7J2ln
bm9yZWQnOiB7fSwgJ2NvbGxlY3RlZCc6IHt9fQ0KICAgIA0KICAgIGRlZiBzYXZl
X21lc3NhZ2VfdHJhY2tpbmcoc2VsZik6DQogICAgICAgICIiIlNhdmUgbWVzc2Fn
ZSB0cmFja2luZyBkYXRhIHRvIGZpbGUiIiINCiAgICAgICAgdHJ5Og0KICAgICAg
ICAgICAgd2l0aCBvcGVuKHNlbGYubWVzc2FnZV90cmFja2luZ19maWxlLCAndycp
IGFzIGY6DQogICAgICAgICAgICAgICAganNvbi5kdW1wKHNlbGYubWVzc2FnZV90
cmFja2luZywgZiwgaW5kZW50PTIpDQogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24g
YXMgZToNCiAgICAgICAgICAgIGxvZ2dlci5lcnJvcihmIkVycm9yIHNhdmluZyBt
ZXNzYWdlIHRyYWNraW5nIGZpbGU6IHtlfSIpDQogICAgDQogICAgZGVmIGNsZWFu
dXBfb2xkX3RyYWNraW5nX2RhdGEoc2VsZik6DQogICAgICAgICIiIlJlbW92ZSB0
cmFja2luZyBkYXRhIG9sZGVyIHRoYW4gdGhlIGlnbm9yZSBkdXJhdGlvbiIiIg0K
ICAgICAgICBpZiBub3QgRFVQTElDQVRFX0NIRUNLX0VOQUJMRUQ6DQogICAgICAg
ICAgICByZXR1cm4NCiAgICAgICAgICAgIA0KICAgICAgICBjdXJyZW50X3RpbWUg
PSB0aW1lLnRpbWUoKQ0KICAgICAgICBjdXRvZmZfdGltZSA9IGN1cnJlbnRfdGlt
ZSAtIERVUExJQ0FURV9JR05PUkVfRFVSQVRJT04NCiAgICAgICAgDQogICAgICAg
ICMgQ2xlYW4gaWdub3JlZCBtZXNzYWdlcw0KICAgICAgICBjbGVhbmVkX2lnbm9y
ZWQgPSB7fQ0KICAgICAgICBmb3IgdXNlcl9pZCwgZGF0YSBpbiBzZWxmLm1lc3Nh
Z2VfdHJhY2tpbmdbJ2lnbm9yZWQnXS5pdGVtcygpOg0KICAgICAgICAgICAgaWYg
ZGF0YS5nZXQoJ3RpbWVzdGFtcCcsIDApID4gY3V0b2ZmX3RpbWU6DQogICAgICAg
ICAgICAgICAgY2xlYW5lZF9pZ25vcmVkW3VzZXJfaWRdID0gZGF0YQ0KICAgICAg
ICANCiAgICAgICAgIyBDbGVhbiBjb2xsZWN0ZWQgbWVzc2FnZXMNCiAgICAgICAg
Y2xlYW5lZF9jb2xsZWN0ZWQgPSB7fQ0KICAgICAgICBmb3IgdXNlcl9pZCwgZGF0
YSBpbiBzZWxmLm1lc3NhZ2VfdHJhY2tpbmdbJ2NvbGxlY3RlZCddLml0ZW1zKCk6
DQogICAgICAgICAgICBpZiBkYXRhLmdldCgndGltZXN0YW1wJywgMCkgPiBjdXRv
ZmZfdGltZToNCiAgICAgICAgICAgICAgICBjbGVhbmVkX2NvbGxlY3RlZFt1c2Vy
X2lkXSA9IGRhdGENCiAgICAgICAgDQogICAgICAgIHNlbGYubWVzc2FnZV90cmFj
a2luZ1snaWdub3JlZCddID0gY2xlYW5lZF9pZ25vcmVkDQogICAgICAgIHNlbGYu
bWVzc2FnZV90cmFja2luZ1snY29sbGVjdGVkJ10gPSBjbGVhbmVkX2NvbGxlY3Rl
ZA0KICAgICAgICBzZWxmLnNhdmVfbWVzc2FnZV90cmFja2luZygpDQogICAgICAg
IA0KICAgICAgICBsb2dnZXIuaW5mbyhmIkNsZWFuZWQgdXAgdHJhY2tpbmcgZGF0
YS4gS2VwdCB7bGVuKGNsZWFuZWRfaWdub3JlZCl9IGlnbm9yZWQgYW5kIHtsZW4o
Y2xlYW5lZF9jb2xsZWN0ZWQpfSBjb2xsZWN0ZWQgZW50cmllcy4iKQ0KICAgIA0K
ICAgIGRlZiBoYXNfZm9yd2FyZGVkX3RvZGF5KHNlbGYsIHVzZXJfaWQ6IGludCkg
LT4gYm9vbDoNCiAgICAgICAgIiIiQ2hlY2sgaWYgd2UndmUgYWxyZWFkeSBmb3J3
YXJkZWQgYSBtZXNzYWdlIGZyb20gdGhpcyB1c2VyIHRvZGF5IiIiDQogICAgICAg
IHJldHVybiBzdHIodXNlcl9pZCkgaW4gc2VsZi5mb3J3YXJkZWRfdG9kYXkNCiAg
ICANCiAgICBkZWYgbWFya19hc19mb3J3YXJkZWQoc2VsZiwgdXNlcl9pZDogaW50
LCBzZW5kZXJfbmFtZTogc3RyKToNCiAgICAgICAgIiIiTWFyayB0aGlzIHVzZXIg
YXMgaGF2aW5nIGEgbWVzc2FnZSBmb3J3YXJkZWQgdG9kYXkiIiINCiAgICAgICAg
c2VsZi5mb3J3YXJkZWRfdG9kYXlbc3RyKHVzZXJfaWQpXSA9IHsNCiAgICAgICAg
ICAgICduYW1lJzogc2VuZGVyX25hbWUsDQogICAgICAgICAgICAndGltZSc6IGRh
dGV0aW1lLm5vdygpLnN0cmZ0aW1lKCclWS0lbS0lZCAlSDolTTolUycpDQogICAg
ICAgIH0NCiAgICAgICAgc2VsZi5zYXZlX2RhaWx5X21lc3NhZ2VzKCkNCiAgICAg
ICAgDQogICAgZGVmIHRyYWNrX2lnbm9yZWRfbWVzc2FnZShzZWxmLCB1c2VyX2lk
OiBpbnQsIHNlbmRlcl9uYW1lOiBzdHIsIHJlYXNvbjogc3RyKToNCiAgICAgICAg
IiIiVHJhY2sgYSBtZXNzYWdlIHRoYXQgd2FzIGlnbm9yZWQiIiINCiAgICAgICAg
aWYgbm90IERVUExJQ0FURV9DSEVDS19FTkFCTEVEOg0KICAgICAgICAgICAgcmV0
dXJuDQogICAgICAgICAgICANCiAgICAgICAgY3VycmVudF90aW1lID0gdGltZS50
aW1lKCkNCiAgICAgICAgc2VsZi5tZXNzYWdlX3RyYWNraW5nWydpZ25vcmVkJ11b
c3RyKHVzZXJfaWQpXSA9IHsNCiAgICAgICAgICAgICduYW1lJzogc2VuZGVyX25h
bWUsDQogICAgICAgICAgICAndGltZXN0YW1wJzogY3VycmVudF90aW1lLA0KICAg
ICAgICAgICAgJ3JlYXNvbic6IHJlYXNvbiwNCiAgICAgICAgICAgICd0aW1lX2Zv
cm1hdHRlZCc6IGRhdGV0aW1lLmZyb210aW1lc3RhbXAoY3VycmVudF90aW1lKS5z
dHJmdGltZSgnJVktJW0tJWQgJUg6JU06JVMnKQ0KICAgICAgICB9DQogICAgICAg
IHNlbGYuc2F2ZV9tZXNzYWdlX3RyYWNraW5nKCkNCiAgICAgICAgbG9nZ2VyLmlu
Zm8oZiJUcmFja2VkIGlnbm9yZWQgbWVzc2FnZSBmcm9tIHtzZW5kZXJfbmFtZX0g
KElEOiB7dXNlcl9pZH0pIC0gUmVhc29uOiB7cmVhc29ufSIpDQogICAgDQogICAg
ZGVmIHRyYWNrX2NvbGxlY3RlZF9tZXNzYWdlKHNlbGYsIHVzZXJfaWQ6IGludCwg
c2VuZGVyX25hbWU6IHN0cik6DQogICAgICAgICIiIlRyYWNrIGEgbWVzc2FnZSB0
aGF0IHdhcyBjb2xsZWN0ZWQvZm9yd2FyZGVkIiIiDQogICAgICAgIGlmIG5vdCBE
VVBMSUNBVEVfQ0hFQ0tfRU5BQkxFRDoNCiAgICAgICAgICAgIHJldHVybg0KICAg
ICAgICAgICAgDQogICAgICAgIGN1cnJlbnRfdGltZSA9IHRpbWUudGltZSgpDQog
ICAgICAgIHNlbGYubWVzc2FnZV90cmFja2luZ1snY29sbGVjdGVkJ11bc3RyKHVz
ZXJfaWQpXSA9IHsNCiAgICAgICAgICAgICduYW1lJzogc2VuZGVyX25hbWUsDQog
ICAgICAgICAgICAndGltZXN0YW1wJzogY3VycmVudF90aW1lLA0KICAgICAgICAg
ICAgJ3RpbWVfZm9ybWF0dGVkJzogZGF0ZXRpbWUuZnJvbXRpbWVzdGFtcChjdXJy
ZW50X3RpbWUpLnN0cmZ0aW1lKCclWS0lbS0lZCAlSDolTTolUycpDQogICAgICAg
IH0NCiAgICAgICAgc2VsZi5zYXZlX21lc3NhZ2VfdHJhY2tpbmcoKQ0KICAgICAg
ICBsb2dnZXIuaW5mbyhmIlRyYWNrZWQgY29sbGVjdGVkIG1lc3NhZ2UgZnJvbSB7
c2VuZGVyX25hbWV9IChJRDoge3VzZXJfaWR9KSIpDQogICAgDQogICAgZGVmIGlz
X21lc3NhZ2VfcmVjZW50bHlfaGFuZGxlZChzZWxmLCB1c2VyX2lkOiBpbnQpIC0+
IGJvb2w6DQogICAgICAgICIiIkNoZWNrIGlmIGEgbWVzc2FnZSBmcm9tIHRoaXMg
dXNlciB3YXMgcmVjZW50bHkgaGFuZGxlZCAod2l0aGluIGlnbm9yZSBkdXJhdGlv
bikiIiINCiAgICAgICAgaWYgbm90IERVUExJQ0FURV9DSEVDS19FTkFCTEVEOg0K
ICAgICAgICAgICAgcmV0dXJuIEZhbHNlDQogICAgICAgICAgICANCiAgICAgICAg
Y3VycmVudF90aW1lID0gdGltZS50aW1lKCkNCiAgICAgICAgY3V0b2ZmX3RpbWUg
PSBjdXJyZW50X3RpbWUgLSBEVVBMSUNBVEVfSUdOT1JFX0RVUkFUSU9ODQogICAg
ICAgIA0KICAgICAgICAjIENoZWNrIGlnbm9yZWQgbWVzc2FnZXMNCiAgICAgICAg
aWYgc3RyKHVzZXJfaWQpIGluIHNlbGYubWVzc2FnZV90cmFja2luZ1snaWdub3Jl
ZCddOg0KICAgICAgICAgICAgaWYgc2VsZi5tZXNzYWdlX3RyYWNraW5nWydpZ25v
cmVkJ11bc3RyKHVzZXJfaWQpXS5nZXQoJ3RpbWVzdGFtcCcsIDApID4gY3V0b2Zm
X3RpbWU6DQogICAgICAgICAgICAgICAgcmV0dXJuIFRydWUNCiAgICAgICAgDQog
ICAgICAgICMgQ2hlY2sgY29sbGVjdGVkIG1lc3NhZ2VzDQogICAgICAgIGlmIHN0
cih1c2VyX2lkKSBpbiBzZWxmLm1lc3NhZ2VfdHJhY2tpbmdbJ2NvbGxlY3RlZCdd
Og0KICAgICAgICAgICAgaWYgc2VsZi5tZXNzYWdlX3RyYWNraW5nWydjb2xsZWN0
ZWQnXVtzdHIodXNlcl9pZCldLmdldCgndGltZXN0YW1wJywgMCkgPiBjdXRvZmZf
dGltZToNCiAgICAgICAgICAgICAgICByZXR1cm4gVHJ1ZQ0KICAgICAgICANCiAg
ICAgICAgcmV0dXJuIEZhbHNlDQogICAgICAgIA0KICAgIGRlZiBnZXRfdHJhY2tp
bmdfc3RhdHMoc2VsZikgLT4gZGljdDoNCiAgICAgICAgIiIiR2V0IGN1cnJlbnQg
dHJhY2tpbmcgc3RhdGlzdGljcyIiIg0KICAgICAgICBpZiBub3QgRFVQTElDQVRF
X0NIRUNLX0VOQUJMRUQ6DQogICAgICAgICAgICByZXR1cm4geydlbmFibGVkJzog
RmFsc2V9DQogICAgICAgICAgICANCiAgICAgICAgY3VycmVudF90aW1lID0gdGlt
ZS50aW1lKCkNCiAgICAgICAgY3V0b2ZmX3RpbWUgPSBjdXJyZW50X3RpbWUgLSBE
VVBMSUNBVEVfSUdOT1JFX0RVUkFUSU9ODQogICAgICAgIA0KICAgICAgICAjIENv
dW50IHJlY2VudCBlbnRyaWVzDQogICAgICAgIHJlY2VudF9pZ25vcmVkID0gc3Vt
KDEgZm9yIGRhdGEgaW4gc2VsZi5tZXNzYWdlX3RyYWNraW5nWydpZ25vcmVkJ10u
dmFsdWVzKCkgDQogICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBkYXRhLmdl
dCgndGltZXN0YW1wJywgMCkgPiBjdXRvZmZfdGltZSkNCiAgICAgICAgcmVjZW50
X2NvbGxlY3RlZCA9IHN1bSgxIGZvciBkYXRhIGluIHNlbGYubWVzc2FnZV90cmFj
a2luZ1snY29sbGVjdGVkJ10udmFsdWVzKCkgDQogICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIGlmIGRhdGEuZ2V0KCd0aW1lc3RhbXAnLCAwKSA+IGN1dG9mZl90
aW1lKQ0KICAgICAgICANCiAgICAgICAgcmV0dXJuIHsNCiAgICAgICAgICAgICdl
bmFibGVkJzogVHJ1ZSwNCiAgICAgICAgICAgICdpZ25vcmVfZHVyYXRpb25fc2Vj
b25kcyc6IERVUExJQ0FURV9JR05PUkVfRFVSQVRJT04sDQogICAgICAgICAgICAn
aWdub3JlX2R1cmF0aW9uX2hvdXJzJzogRFVQTElDQVRFX0lHTk9SRV9EVVJBVElP
TiAvIDM2MDAsDQogICAgICAgICAgICAncmVjZW50X2lnbm9yZWQnOiByZWNlbnRf
aWdub3JlZCwNCiAgICAgICAgICAgICdyZWNlbnRfY29sbGVjdGVkJzogcmVjZW50
X2NvbGxlY3RlZCwNCiAgICAgICAgICAgICd0b3RhbF9pZ25vcmVkJzogbGVuKHNl
bGYubWVzc2FnZV90cmFja2luZ1snaWdub3JlZCddKSwNCiAgICAgICAgICAgICd0
b3RhbF9jb2xsZWN0ZWQnOiBsZW4oc2VsZi5tZXNzYWdlX3RyYWNraW5nWydjb2xs
ZWN0ZWQnXSksDQogICAgICAgICAgICAnbGFzdF9jbGVhbnVwJzogZGF0ZXRpbWUu
bm93KCkuc3RyZnRpbWUoJyVZLSVtLSVkICVIOiVNOiVTJykNCiAgICAgICAgfQ0K
ICAgIA0KICAgIGRlZiBkaXNwbGF5X3RyYWNraW5nX2luZm8oc2VsZik6DQogICAg
ICAgICIiIkRpc3BsYXkgY3VycmVudCB0cmFja2luZyBpbmZvcm1hdGlvbiIiIg0K
ICAgICAgICBzdGF0cyA9IHNlbGYuZ2V0X3RyYWNraW5nX3N0YXRzKCkNCiAgICAg
ICAgDQogICAgICAgIGlmIG5vdCBzdGF0c1snZW5hYmxlZCddOg0KICAgICAgICAg
ICAgbG9nZ2VyLmluZm8oIk1lc3NhZ2UgdHJhY2tpbmcgaXMgZGlzYWJsZWQiKQ0K
ICAgICAgICAgICAgcmV0dXJuDQogICAgICAgIA0KICAgICAgICBsb2dnZXIuaW5m
bygiPT09IE1lc3NhZ2UgVHJhY2tpbmcgQ29uZmlndXJhdGlvbiA9PT0iKQ0KICAg
ICAgICBsb2dnZXIuaW5mbyhmIklnbm9yZSBEdXJhdGlvbjoge3N0YXRzWydpZ25v
cmVfZHVyYXRpb25faG91cnMnXTouMWZ9IGhvdXJzICh7c3RhdHNbJ2lnbm9yZV9k
dXJhdGlvbl9zZWNvbmRzJ119IHNlY29uZHMpIikNCiAgICAgICAgbG9nZ2VyLmlu
Zm8oZiJSZWNlbnQgSWdub3JlZCBNZXNzYWdlczoge3N0YXRzWydyZWNlbnRfaWdu
b3JlZCddfSIpDQogICAgICAgIGxvZ2dlci5pbmZvKGYiUmVjZW50IENvbGxlY3Rl
ZCBNZXNzYWdlczoge3N0YXRzWydyZWNlbnRfY29sbGVjdGVkJ119IikNCiAgICAg
ICAgbG9nZ2VyLmluZm8oZiJUb3RhbCBJZ25vcmVkIChhbGwgdGltZSk6IHtzdGF0
c1sndG90YWxfaWdub3JlZCddfSIpDQogICAgICAgIGxvZ2dlci5pbmZvKGYiVG90
YWwgQ29sbGVjdGVkIChhbGwgdGltZSk6IHtzdGF0c1sndG90YWxfY29sbGVjdGVk
J119IikNCiAgICAgICAgbG9nZ2VyLmluZm8oZiJMYXN0IENsZWFudXA6IHtzdGF0
c1snbGFzdF9jbGVhbnVwJ119IikNCiAgICAgICAgbG9nZ2VyLmluZm8oIj09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0iKQ0KICAgICAgICANCiAg
ICBhc3luYyBkZWYgc3RhcnRfcGVyaW9kaWNfY2xlYW51cChzZWxmKToNCiAgICAg
ICAgIiIiU3RhcnQgcGVyaW9kaWMgY2xlYW51cCBvZiBvbGQgdHJhY2tpbmcgZGF0
YSIiIg0KICAgICAgICBpZiBub3QgRFVQTElDQVRFX0NIRUNLX0VOQUJMRUQ6DQog
ICAgICAgICAgICByZXR1cm4NCiAgICAgICAgICAgIA0KICAgICAgICBhc3luYyBk
ZWYgY2xlYW51cF90YXNrKCk6DQogICAgICAgICAgICB3aGlsZSBub3Qgc2h1dGRv
d25fZXZlbnQuaXNfc2V0KCk6DQogICAgICAgICAgICAgICAgdHJ5Og0KICAgICAg
ICAgICAgICAgICAgICAjIFdhaXQgZm9yIHRoZSBjbGVhbnVwIGludGVydmFsICho
YWxmIG9mIGlnbm9yZSBkdXJhdGlvbikNCiAgICAgICAgICAgICAgICAgICAgY2xl
YW51cF9pbnRlcnZhbCA9IG1heChEVVBMSUNBVEVfSUdOT1JFX0RVUkFUSU9OIC8v
IDIsIDMwMCkgICMgQXQgbGVhc3QgNSBtaW51dGVzDQogICAgICAgICAgICAgICAg
ICAgIGF3YWl0IGFzeW5jaW8uc2xlZXAoY2xlYW51cF9pbnRlcnZhbCkNCiAgICAg
ICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgIGlmIG5vdCBzaHV0
ZG93bl9ldmVudC5pc19zZXQoKToNCiAgICAgICAgICAgICAgICAgICAgICAgIHNl
bGYuY2xlYW51cF9vbGRfdHJhY2tpbmdfZGF0YSgpDQogICAgICAgICAgICAgICAg
ICAgICAgICANCiAgICAgICAgICAgICAgICBleGNlcHQgYXN5bmNpby5DYW5jZWxs
ZWRFcnJvcjoNCiAgICAgICAgICAgICAgICAgICAgYnJlYWsNCiAgICAgICAgICAg
ICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6DQogICAgICAgICAgICAgICAgICAg
IGxvZ2dlci5lcnJvcihmIkVycm9yIGluIHBlcmlvZGljIGNsZWFudXA6IHtlfSIp
DQogICAgICAgICAgICAgICAgICAgIGF3YWl0IGFzeW5jaW8uc2xlZXAoNjApICAj
IFdhaXQgYSBtaW51dGUgYmVmb3JlIHJldHJ5aW5nDQogICAgICAgIA0KICAgICAg
ICAjIFN0YXJ0IHRoZSBjbGVhbnVwIHRhc2sNCiAgICAgICAgYXN5bmNpby5jcmVh
dGVfdGFzayhjbGVhbnVwX3Rhc2soKSkNCiAgICAgICAgbG9nZ2VyLmluZm8oZiJT
dGFydGVkIHBlcmlvZGljIGNsZWFudXAgdGFzayAoZXZlcnkge21heChEVVBMSUNB
VEVfSUdOT1JFX0RVUkFUSU9OIC8vIDIsIDMwMCl9IHNlY29uZHMpIikNCiAgICAg
ICAgDQogICAgYXN5bmMgZGVmIHNldHVwX2NsaWVudChzZWxmKToNCiAgICAgICAg
IiIiSW5pdGlhbGl6ZSBhbmQgYXV0aGVudGljYXRlIHRoZSBUZWxlZ3JhbSBjbGll
bnQiIiINCiAgICAgICAgdHJ5Og0KICAgICAgICAgICAgbG9nZ2VyLmluZm8oIlN0
YXJ0aW5nIFRlbGVncmFtIGNsaWVudC4uLiIpDQogICAgICAgICAgICBhd2FpdCBz
ZWxmLmNsaWVudC5zdGFydCgpDQogICAgICAgICAgICANCiAgICAgICAgICAgICMg
R2V0IGJvdCBlbnRpdHkgb25jZSBhbmQgY2FjaGUgaXQNCiAgICAgICAgICAgIHNl
bGYuYm90X2VudGl0eSA9IGF3YWl0IHNlbGYuY2xpZW50LmdldF9lbnRpdHkoQk9U
X1VTRVJOQU1FKQ0KICAgICAgICAgICAgbG9nZ2VyLmluZm8oZiJTdWNjZXNzZnVs
bHkgY29ubmVjdGVkIHRvIGJvdDoge0JPVF9VU0VSTkFNRX0iKQ0KICAgICAgICAg
ICAgDQogICAgICAgICAgICAjIFJlZ2lzdGVyIGV2ZW50IGhhbmRsZXIgZm9yIHBy
aXZhdGUgbWVzc2FnZXMNCiAgICAgICAgICAgIHNlbGYuY2xpZW50LmFkZF9ldmVu
dF9oYW5kbGVyKHNlbGYuaGFuZGxlX25ld19tZXNzYWdlLCBldmVudHMuTmV3TWVz
c2FnZShpbmNvbWluZz1UcnVlLCBmdW5jPWxhbWJkYSBlOiBlLmlzX3ByaXZhdGUp
KQ0KICAgICAgICAgICAgbG9nZ2VyLmluZm8oIkV2ZW50IGhhbmRsZXIgcmVnaXN0
ZXJlZCBzdWNjZXNzZnVsbHkiKQ0KICAgICAgICAgICAgDQogICAgICAgICAgICAj
IERpc3BsYXkgdHJhY2tpbmcgY29uZmlndXJhdGlvbg0KICAgICAgICAgICAgc2Vs
Zi5kaXNwbGF5X3RyYWNraW5nX2luZm8oKQ0KICAgICAgICAgICAgDQogICAgICAg
ICAgICAjIFN0YXJ0IHBlcmlvZGljIGNsZWFudXAgdGFzaw0KICAgICAgICAgICAg
YXdhaXQgc2VsZi5zdGFydF9wZXJpb2RpY19jbGVhbnVwKCkNCiAgICAgICAgICAg
IA0KICAgICAgICAgICAgcmV0dXJuIFRydWUNCiAgICAgICAgICAgIA0KICAgICAg
ICBleGNlcHQgU2Vzc2lvblBhc3N3b3JkTmVlZGVkRXJyb3I6DQogICAgICAgICAg
ICBsb2dnZXIuZXJyb3IoIlR3by1mYWN0b3IgYXV0aGVudGljYXRpb24gaXMgZW5h
YmxlZC4gUGxlYXNlIHByb3ZpZGUgeW91ciBwYXNzd29yZC4iKQ0KICAgICAgICAg
ICAgcmV0dXJuIEZhbHNlDQogICAgICAgIGV4Y2VwdCBQaG9uZU51bWJlckludmFs
aWRFcnJvcjoNCiAgICAgICAgICAgIGxvZ2dlci5lcnJvcigiSW52YWxpZCBwaG9u
ZSBudW1iZXIuIFBsZWFzZSBjaGVjayB5b3VyIGNyZWRlbnRpYWxzLiIpDQogICAg
ICAgICAgICByZXR1cm4gRmFsc2UNCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBh
cyBlOg0KICAgICAgICAgICAgbG9nZ2VyLmVycm9yKGYiRXJyb3Igc2V0dGluZyB1
cCBjbGllbnQ6IHtlfSIpDQogICAgICAgICAgICByZXR1cm4gRmFsc2UNCg0KICAg
IGFzeW5jIGRlZiBoYW5kbGVfbmV3X21lc3NhZ2Uoc2VsZiwgZXZlbnQpOg0KICAg
ICAgICAiIiJIYW5kbGUgbmV3IGluY29taW5nIHByaXZhdGUgbWVzc2FnZXMgYW5k
IGZvcndhcmQgdGhlbSB0byB0aGUgYm90IiIiDQogICAgICAgIHRyeToNCiAgICAg
ICAgICAgIG1lc3NhZ2UgPSBldmVudC5tZXNzYWdlDQogICAgICAgICAgICBzZW5k
ZXIgPSBhd2FpdCBtZXNzYWdlLmdldF9zZW5kZXIoKQ0KICAgICAgICAgICAgDQog
ICAgICAgICAgICBpZiBub3Qgc2VuZGVyOg0KICAgICAgICAgICAgICAgIGxvZ2dl
ci53YXJuaW5nKCJDb3VsZCBub3QgZ2V0IHNlbmRlciBpbmZvcm1hdGlvbiIpDQog
ICAgICAgICAgICAgICAgcmV0dXJuDQogICAgICAgICAgICANCiAgICAgICAgICAg
ICMgQnVpbGQgc2VuZGVyIG5hbWUNCiAgICAgICAgICAgIHNlbmRlcl9uYW1lID0g
c2VsZi5idWlsZF9zZW5kZXJfbmFtZShzZW5kZXIpDQogICAgICAgICAgICBzZW5k
ZXJfaWQgPSBzZW5kZXIuaWQNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgIyBD
aGVjayBpZiB3ZSd2ZSBhbHJlYWR5IGhhbmRsZWQgYSBtZXNzYWdlIGZyb20gdGhp
cyB1c2VyIHJlY2VudGx5ICh3aXRoaW4gaWdub3JlIGR1cmF0aW9uKQ0KICAgICAg
ICAgICAgaWYgc2VsZi5pc19tZXNzYWdlX3JlY2VudGx5X2hhbmRsZWQoc2VuZGVy
X2lkKToNCiAgICAgICAgICAgICAgICBsb2dnZXIuaW5mbyhmIkFscmVhZHkgaGFu
ZGxlZCBhIG1lc3NhZ2UgZnJvbSAne3NlbmRlcl9uYW1lfScgKElEOiB7c2VuZGVy
X2lkfSkgcmVjZW50bHkuIFNraXBwaW5nLiIpDQogICAgICAgICAgICAgICAgcmV0
dXJuDQogICAgICAgICAgICANCiAgICAgICAgICAgICMgQ2hlY2sgaWYgd2UndmUg
YWxyZWFkeSBmb3J3YXJkZWQgYSBtZXNzYWdlIGZyb20gdGhpcyB1c2VyIHRvZGF5
DQogICAgICAgICAgICBpZiBzZWxmLmhhc19mb3J3YXJkZWRfdG9kYXkoc2VuZGVy
X2lkKToNCiAgICAgICAgICAgICAgICBsb2dnZXIuaW5mbyhmIkFscmVhZHkgZm9y
d2FyZGVkIGEgbWVzc2FnZSBmcm9tICd7c2VuZGVyX25hbWV9JyAoSUQ6IHtzZW5k
ZXJfaWR9KSB0b2RheS4gU2tpcHBpbmcuIikNCiAgICAgICAgICAgICAgICBzZWxm
LnRyYWNrX2lnbm9yZWRfbWVzc2FnZShzZW5kZXJfaWQsIHNlbmRlcl9uYW1lLCAi
QWxyZWFkeSBmb3J3YXJkZWQgdG9kYXkiKQ0KICAgICAgICAgICAgICAgIHJldHVy
bg0KICAgICAgICAgICAgDQogICAgICAgICAgICAjIENoZWNrIGlmIHRoZSBtZXNz
YWdlIHNob3VsZCBiZSBmb3J3YXJkZWQNCiAgICAgICAgICAgIGlmIG5vdCBzZWxm
LnNob3VsZF9mb3J3YXJkX21lc3NhZ2UobWVzc2FnZSwgc2VuZGVyLCBzZW5kZXJf
bmFtZSk6DQogICAgICAgICAgICAgICAgbG9nZ2VyLmluZm8oZiJJZ25vcmluZyBt
ZXNzYWdlIGZyb20gJ3tzZW5kZXJfbmFtZX0nIChJRDoge3NlbmRlcl9pZH0pIC0g
ZG9lc24ndCBtYXRjaCBjcml0ZXJpYSIpDQogICAgICAgICAgICAgICAgc2VsZi50
cmFja19pZ25vcmVkX21lc3NhZ2Uoc2VuZGVyX2lkLCBzZW5kZXJfbmFtZSwgIkRv
ZXNuJ3QgbWF0Y2ggZm9yd2FyZGluZyBjcml0ZXJpYSIpDQogICAgICAgICAgICAg
ICAgcmV0dXJuDQogICAgICAgICAgICANCiAgICAgICAgICAgIGxvZ2dlci5pbmZv
KGYiUHJvY2Vzc2luZyBGSVJTVCBtZXNzYWdlIHRvZGF5IGZyb20gJ3tzZW5kZXJf
bmFtZX0nIChJRDoge3NlbmRlcl9pZH0pOiB7bWVzc2FnZS50ZXh0Wzo1MF19Li4u
IikNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgIyBGb3J3YXJkIG1lc3NhZ2Ug
d2l0aCBzZW5kZXIgaW5mbw0KICAgICAgICAgICAgc3VjY2VzcyA9IGF3YWl0IHNl
bGYuZm9yd2FyZF9tZXNzYWdlX3dpdGhfaW5mbyhtZXNzYWdlLCBzZW5kZXJfbmFt
ZSwgc2VuZGVyX2lkKQ0KICAgICAgICAgICAgDQogICAgICAgICAgICAjIE1hcmsg
YXMgZm9yd2FyZGVkIG9ubHkgaWYgc3VjY2Vzc2Z1bA0KICAgICAgICAgICAgaWYg
c3VjY2VzczoNCiAgICAgICAgICAgICAgICBzZWxmLm1hcmtfYXNfZm9yd2FyZGVk
KHNlbmRlcl9pZCwgc2VuZGVyX25hbWUpDQogICAgICAgICAgICAgICAgc2VsZi50
cmFja19jb2xsZWN0ZWRfbWVzc2FnZShzZW5kZXJfaWQsIHNlbmRlcl9uYW1lKQ0K
ICAgICAgICAgICAgICAgIGxvZ2dlci5pbmZvKGYiTWFya2VkICd7c2VuZGVyX25h
bWV9JyBhcyBmb3J3YXJkZWQgZm9yIHRvZGF5IGFuZCB0cmFja2VkIGFzIGNvbGxl
Y3RlZCIpDQogICAgICAgICAgICBlbHNlOg0KICAgICAgICAgICAgICAgIGxvZ2dl
ci53YXJuaW5nKGYiRmFpbGVkIHRvIGZvcndhcmQgbWVzc2FnZSBmcm9tICd7c2Vu
ZGVyX25hbWV9JyAoSUQ6IHtzZW5kZXJfaWR9KSIpDQogICAgICAgICAgICAgICAg
c2VsZi50cmFja19pZ25vcmVkX21lc3NhZ2Uoc2VuZGVyX2lkLCBzZW5kZXJfbmFt
ZSwgIkZvcndhcmRpbmcgZmFpbGVkIikNCiAgICAgICAgICAgIA0KICAgICAgICBl
eGNlcHQgRXhjZXB0aW9uIGFzIGU6DQogICAgICAgICAgICBsb2dnZXIuZXJyb3Io
ZiJFcnJvciBoYW5kbGluZyBtZXNzYWdlOiB7ZX0iKQ0KICAgIA0KICAgIGRlZiBi
dWlsZF9zZW5kZXJfbmFtZShzZWxmLCBzZW5kZXIpIC0+IHN0cjoNCiAgICAgICAg
IiIiQnVpbGQgYSBjb21wbGV0ZSBuYW1lIGZyb20gc2VuZGVyIGluZm9ybWF0aW9u
IiIiDQogICAgICAgIG5hbWVfcGFydHMgPSBbXQ0KICAgICAgICANCiAgICAgICAg
aWYgaGFzYXR0cihzZW5kZXIsICdmaXJzdF9uYW1lJykgYW5kIHNlbmRlci5maXJz
dF9uYW1lOg0KICAgICAgICAgICAgbmFtZV9wYXJ0cy5hcHBlbmQoc2VuZGVyLmZp
cnN0X25hbWUuc3RyaXAoKSkNCiAgICAgICAgDQogICAgICAgIGlmIGhhc2F0dHIo
c2VuZGVyLCAnbGFzdF9uYW1lJykgYW5kIHNlbmRlci5sYXN0X25hbWU6DQogICAg
ICAgICAgICBuYW1lX3BhcnRzLmFwcGVuZChzZW5kZXIubGFzdF9uYW1lLnN0cmlw
KCkpDQogICAgICAgIA0KICAgICAgICBpZiBoYXNhdHRyKHNlbmRlciwgJ3VzZXJu
YW1lJykgYW5kIHNlbmRlci51c2VybmFtZToNCiAgICAgICAgICAgIHVzZXJuYW1l
ID0gZiJAe3NlbmRlci51c2VybmFtZX0iDQogICAgICAgICAgICBpZiBuYW1lX3Bh
cnRzOg0KICAgICAgICAgICAgICAgIHJldHVybiBmInsnICcuam9pbihuYW1lX3Bh
cnRzKX0gKHt1c2VybmFtZX0pIg0KICAgICAgICAgICAgZWxzZToNCiAgICAgICAg
ICAgICAgICByZXR1cm4gdXNlcm5hbWUNCiAgICAgICAgDQogICAgICAgIHJldHVy
biAnICcuam9pbihuYW1lX3BhcnRzKSBpZiBuYW1lX3BhcnRzIGVsc2UgZiJVbmtu
b3duIFVzZXIiDQogICAgDQogICAgZGVmIHNob3VsZF9mb3J3YXJkX21lc3NhZ2Uo
c2VsZiwgbWVzc2FnZSwgc2VuZGVyLCBzZW5kZXJfbmFtZTogc3RyKSAtPiBib29s
Og0KICAgICAgICAiIiJEZXRlcm1pbmUgaWYgYSBtZXNzYWdlIHNob3VsZCBiZSBm
b3J3YXJkZWQgYmFzZWQgb24gZmlsdGVyaW5nIGNyaXRlcmlhIiIiDQogICAgICAg
ICMgTXVzdCBoYXZlIHRleHQgY29udGVudA0KICAgICAgICBpZiBub3QgbWVzc2Fn
ZS50ZXh0Og0KICAgICAgICAgICAgcmV0dXJuIEZhbHNlDQogICAgICAgIA0KICAg
ICAgICAjIENoZWNrIGlmIHRoZSBzZW5kZXIncyBuYW1lIGNvbnRhaW5zIGEgMy00
IGRpZ2l0IG51bWJlciBvciBoYXMgYSBmaXJzdCBhbmQgbGFzdCBuYW1lDQogICAg
ICAgIGhhc19kaWdpdHMgPSBib29sKHJlLnNlYXJjaChyJ1xkezMsNH0nLCBzZW5k
ZXJfbmFtZSkpDQogICAgICAgIGhhc19mdWxsX25hbWUgPSBoYXNhdHRyKHNlbmRl
ciwgJ2ZpcnN0X25hbWUnKSBhbmQgaGFzYXR0cihzZW5kZXIsICdsYXN0X25hbWUn
KSBhbmQgc2VuZGVyLmZpcnN0X25hbWUgYW5kIHNlbmRlci5sYXN0X25hbWUNCiAg
ICAgICAgDQogICAgICAgIHJldHVybiBoYXNfZGlnaXRzIG9yIGhhc19mdWxsX25h
bWUNCiAgICANCiAgICBhc3luYyBkZWYgZm9yd2FyZF9tZXNzYWdlX3dpdGhfaW5m
byhzZWxmLCBtZXNzYWdlLCBzZW5kZXJfbmFtZTogc3RyLCBzZW5kZXJfaWQ6IGlu
dCkgLT4gYm9vbDoNCiAgICAgICAgIiIiRm9yd2FyZCBtZXNzYWdlIHRvIGJvdCB3
aXRoIHNlbmRlciBpbmZvcm1hdGlvbi4gUmV0dXJucyBUcnVlIGlmIHN1Y2Nlc3Nm
dWwuIiIiDQogICAgICAgIHRyeToNCiAgICAgICAgICAgIGlmIG5vdCBzZWxmLmJv
dF9lbnRpdHk6DQogICAgICAgICAgICAgICAgbG9nZ2VyLmVycm9yKCJCb3QgZW50
aXR5IG5vdCBhdmFpbGFibGUsIHRyeWluZyB0byByZWNvbm5lY3QuLi4iKQ0KICAg
ICAgICAgICAgICAgIHRyeToNCiAgICAgICAgICAgICAgICAgICAgc2VsZi5ib3Rf
ZW50aXR5ID0gYXdhaXQgc2VsZi5jbGllbnQuZ2V0X2VudGl0eShCT1RfVVNFUk5B
TUUpDQogICAgICAgICAgICAgICAgICAgIGxvZ2dlci5pbmZvKGYiUmVjb25uZWN0
ZWQgdG8gYm90OiB7c2VsZi5ib3RfZW50aXR5LnVzZXJuYW1lfSIpDQogICAgICAg
ICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOg0KICAgICAgICAgICAgICAg
ICAgICBsb2dnZXIuZXJyb3IoZiJGYWlsZWQgdG8gcmVjb25uZWN0IHRvIGJvdDog
e2V9IikNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIEZhbHNlDQogICAgICAg
ICAgICANCiAgICAgICAgICAgICMgQ3JlYXRlIGEgZm9ybWF0dGVkIG1lc3NhZ2Ug
d2l0aCBzZW5kZXIgaW5mbw0KICAgICAgICAgICAgZm9ybWF0dGVkX21lc3NhZ2Ug
PSBmIvCfk6ggRklSU1QgTUVTU0FHRSBUT0RBWSBmcm9tOiB7c2VuZGVyX25hbWV9
XG4iIFwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGYi8J+RpCBVc2Vy
IElEOiB7c2VuZGVyX2lkfVxuIiBcDQogICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBmIuKPsCBUaW1lOiB7bWVzc2FnZS5kYXRlLnN0cmZ0aW1lKCclWS0lbS0l
ZCAlSDolTTolUycpfVxuIiBcDQogICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBmInsnPScqNDB9XG4iIFwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IGYie21lc3NhZ2UudGV4dH0iDQogICAgICAgICAgICANCiAgICAgICAgICAgICMg
U2VuZCB0aGUgZm9ybWF0dGVkIG1lc3NhZ2UgdG8gdGhlIHNwZWNpZmljIGJvdA0K
ICAgICAgICAgICAgbG9nZ2VyLmluZm8oZiJTZW5kaW5nIG1lc3NhZ2UgdG8gYm90
IHtzZWxmLmJvdF9lbnRpdHkudXNlcm5hbWV9IChJRDoge3NlbGYuYm90X2VudGl0
eS5pZH0pIikNCiAgICAgICAgICAgIGF3YWl0IHNlbGYuY2xpZW50LnNlbmRfbWVz
c2FnZShzZWxmLmJvdF9lbnRpdHksIGZvcm1hdHRlZF9tZXNzYWdlKQ0KICAgICAg
ICAgICAgbG9nZ2VyLmluZm8oZiJNZXNzYWdlIGZvcndhcmRlZCBzdWNjZXNzZnVs
bHkgZnJvbSB7c2VuZGVyX25hbWV9IHRvIGJvdCB7c2VsZi5ib3RfZW50aXR5LnVz
ZXJuYW1lfSIpDQogICAgICAgICAgICByZXR1cm4gVHJ1ZQ0KICAgICAgICAgICAg
DQogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToNCiAgICAgICAgICAgIGxv
Z2dlci5lcnJvcihmIkVycm9yIGZvcndhcmRpbmcgbWVzc2FnZSBmcm9tIHtzZW5k
ZXJfbmFtZX06IHtlfSIpDQogICAgICAgICAgICAjIFRyeSB0byByZWZyZXNoIGJv
dCBlbnRpdHkgb24gbmV4dCBhdHRlbXB0DQogICAgICAgICAgICBzZWxmLmJvdF9l
bnRpdHkgPSBOb25lDQogICAgICAgICAgICByZXR1cm4gRmFsc2UNCg0KICAgIGFz
eW5jIGRlZiBydW5fd2l0aF9yZXRyeShzZWxmKToNCiAgICAgICAgIiIiUnVuIHRo
ZSB1c2VyYm90IHdpdGggcmV0cnkgbG9naWMiIiINCiAgICAgICAgd2hpbGUgc2Vs
Zi5yZXRyeV9jb3VudCA8IHNlbGYubWF4X3JldHJpZXMgYW5kIG5vdCBzaHV0ZG93
bl9ldmVudC5pc19zZXQoKToNCiAgICAgICAgICAgIHRyeToNCiAgICAgICAgICAg
ICAgICBpZiBhd2FpdCBzZWxmLnNldHVwX2NsaWVudCgpOg0KICAgICAgICAgICAg
ICAgICAgICBsb2dnZXIuaW5mbygiVXNlcmJvdCBpcyBydW5uaW5nIGFuZCBsaXN0
ZW5pbmcgZm9yIHByaXZhdGUgbWVzc2FnZXMuLi4iKQ0KICAgICAgICAgICAgICAg
ICAgICANCiAgICAgICAgICAgICAgICAgICAgIyBSZXNldCByZXRyeSBjb3VudCBv
biBzdWNjZXNzZnVsIGNvbm5lY3Rpb24NCiAgICAgICAgICAgICAgICAgICAgc2Vs
Zi5yZXRyeV9jb3VudCA9IDANCiAgICAgICAgICAgICAgICAgICAgDQogICAgICAg
ICAgICAgICAgICAgICMgQ3JlYXRlIGEgdGFzayBmb3IgcnVubmluZyB0aGUgY2xp
ZW50DQogICAgICAgICAgICAgICAgICAgIHJ1bl90YXNrID0gYXN5bmNpby5jcmVh
dGVfdGFzayhzZWxmLmNsaWVudC5ydW5fdW50aWxfZGlzY29ubmVjdGVkKCkpDQog
ICAgICAgICAgICAgICAgICAgIHNodXRkb3duX3Rhc2sgPSBhc3luY2lvLmNyZWF0
ZV90YXNrKHNodXRkb3duX2V2ZW50LndhaXQoKSkNCiAgICAgICAgICAgICAgICAg
ICAgDQogICAgICAgICAgICAgICAgICAgICMgV2FpdCBmb3IgZWl0aGVyIHRoZSBj
bGllbnQgdG8gZGlzY29ubmVjdCBvciBzaHV0ZG93biBzaWduYWwNCiAgICAgICAg
ICAgICAgICAgICAgZG9uZSwgcGVuZGluZyA9IGF3YWl0IGFzeW5jaW8ud2FpdCgN
CiAgICAgICAgICAgICAgICAgICAgICAgIFtydW5fdGFzaywgc2h1dGRvd25fdGFz
a10sIA0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuX3doZW49YXN5bmNp
by5GSVJTVF9DT01QTEVURUQNCiAgICAgICAgICAgICAgICAgICAgKQ0KICAgICAg
ICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgIyBDYW5jZWwgYW55
IHBlbmRpbmcgdGFza3MNCiAgICAgICAgICAgICAgICAgICAgZm9yIHRhc2sgaW4g
cGVuZGluZzoNCiAgICAgICAgICAgICAgICAgICAgICAgIHRhc2suY2FuY2VsKCkN
CiAgICAgICAgICAgICAgICAgICAgICAgIHRyeToNCiAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBhd2FpdCB0YXNrDQogICAgICAgICAgICAgICAgICAgICAgICBl
eGNlcHQgYXN5bmNpby5DYW5jZWxsZWRFcnJvcjoNCiAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBwYXNzDQogICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAg
ICAgICAgICAgICAjIElmIHNodXRkb3duIHdhcyByZXF1ZXN0ZWQsIGJyZWFrIHRo
ZSBsb29wDQogICAgICAgICAgICAgICAgICAgIGlmIHNodXRkb3duX2V2ZW50Lmlz
X3NldCgpOg0KICAgICAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLmluZm8oIlNo
dXRkb3duIHJlcXVlc3RlZCwgZXhpdGluZy4uLiIpDQogICAgICAgICAgICAgICAg
ICAgICAgICBicmVhaw0KICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAg
ICAgICBlbHNlOg0KICAgICAgICAgICAgICAgICAgICBsb2dnZXIuZXJyb3IoIkZh
aWxlZCB0byBzZXR1cCBjbGllbnQiKQ0KICAgICAgICAgICAgICAgICAgICBicmVh
aw0KICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgIGV4Y2VwdCBLZXli
b2FyZEludGVycnVwdDoNCiAgICAgICAgICAgICAgICBsb2dnZXIuaW5mbygiUmVj
ZWl2ZWQga2V5Ym9hcmQgaW50ZXJydXB0LCBzaHV0dGluZyBkb3duLi4uIikNCiAg
ICAgICAgICAgICAgICBicmVhaw0KICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlv
biBhcyBlOg0KICAgICAgICAgICAgICAgIGxvZ2dlci5lcnJvcihmIlVuZXhwZWN0
ZWQgZXJyb3I6IHtlfSIpDQogICAgICAgICAgICAgICAgc2VsZi5yZXRyeV9jb3Vu
dCArPSAxDQogICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgaWYgc2Vs
Zi5yZXRyeV9jb3VudCA8IHNlbGYubWF4X3JldHJpZXMgYW5kIG5vdCBzaHV0ZG93
bl9ldmVudC5pc19zZXQoKToNCiAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLmlu
Zm8oZiJSZXRyeWluZyBpbiB7c2VsZi5yZXRyeV9kZWxheX0gc2Vjb25kcy4uLiAo
QXR0ZW1wdCB7c2VsZi5yZXRyeV9jb3VudH0ve3NlbGYubWF4X3JldHJpZXN9KSIp
DQogICAgICAgICAgICAgICAgICAgIHRyeToNCiAgICAgICAgICAgICAgICAgICAg
ICAgIGF3YWl0IGFzeW5jaW8ud2FpdF9mb3Ioc2h1dGRvd25fZXZlbnQud2FpdCgp
LCB0aW1lb3V0PXNlbGYucmV0cnlfZGVsYXkpDQogICAgICAgICAgICAgICAgICAg
ICAgICBicmVhayAgIyBTaHV0ZG93biByZXF1ZXN0ZWQgZHVyaW5nIGRlbGF5DQog
ICAgICAgICAgICAgICAgICAgIGV4Y2VwdCBhc3luY2lvLlRpbWVvdXRFcnJvcjoN
CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlICAjIENvbnRpbnVlIHdp
dGggcmV0cnkNCiAgICAgICAgICAgICAgICBlbHNlOg0KICAgICAgICAgICAgICAg
ICAgICBsb2dnZXIuZXJyb3IoIk1heCByZXRyaWVzIHJlYWNoZWQgb3Igc2h1dGRv
d24gcmVxdWVzdGVkLCBnaXZpbmcgdXAiKQ0KICAgICAgICAgICAgICAgICAgICBi
cmVhaw0KICAgICAgICAgICAgDQogICAgICAgICAgICBmaW5hbGx5Og0KICAgICAg
ICAgICAgICAgIGlmIHNlbGYuY2xpZW50IGFuZCBzZWxmLmNsaWVudC5pc19jb25u
ZWN0ZWQoKToNCiAgICAgICAgICAgICAgICAgICAgdHJ5Og0KICAgICAgICAgICAg
ICAgICAgICAgICAgYXdhaXQgc2VsZi5jbGllbnQuZGlzY29ubmVjdCgpDQogICAg
ICAgICAgICAgICAgICAgICAgICBsb2dnZXIuaW5mbygiQ2xpZW50IGRpc2Nvbm5l
Y3RlZCBzdWNjZXNzZnVsbHkiKQ0KICAgICAgICAgICAgICAgICAgICBleGNlcHQg
RXhjZXB0aW9uIGFzIGU6DQogICAgICAgICAgICAgICAgICAgICAgICBsb2dnZXIu
ZXJyb3IoZiJFcnJvciBkaXNjb25uZWN0aW5nIGNsaWVudDoge2V9IikNCg0KZGVm
IHNpZ25hbF9oYW5kbGVyKHNpZ251bSwgZnJhbWUpOg0KICAgICIiIkhhbmRsZSBz
aHV0ZG93biBzaWduYWxzIGdyYWNlZnVsbHkiIiINCiAgICBsb2dnZXIuaW5mbyhm
IlJlY2VpdmVkIHNpZ25hbCB7c2lnbnVtfSwgaW5pdGlhdGluZyBzaHV0ZG93bi4u
LiIpDQogICAgc2h1dGRvd25fZXZlbnQuc2V0KCkNCiAgICAjIEZvcmNlIGRpc2Nv
bm5lY3QgdGhlIGNsaWVudCBpZiBpdCBleGlzdHMNCiAgICBpZiAnY2xpZW50JyBp
biBnbG9iYWxzKCkgYW5kIGNsaWVudCBhbmQgY2xpZW50LmlzX2Nvbm5lY3RlZCgp
Og0KICAgICAgICB0cnk6DQogICAgICAgICAgICBhc3luY2lvLmNyZWF0ZV90YXNr
KGNsaWVudC5kaXNjb25uZWN0KCkpDQogICAgICAgIGV4Y2VwdDoNCiAgICAgICAg
ICAgIHBhc3MNCg0KZGVmIHBhcnNlX2FyZ3VtZW50cygpOg0KICAgICIiIlBhcnNl
IGNvbW1hbmQgbGluZSBhcmd1bWVudHMiIiINCiAgICBwYXJzZXIgPSBhcmdwYXJz
ZS5Bcmd1bWVudFBhcnNlcihkZXNjcmlwdGlvbj0nVGVsZWdyYW0gVXNlcmJvdCBG
b3J3YXJkZXIgd2l0aCBNZXNzYWdlIFRyYWNraW5nJykNCiAgICBwYXJzZXIuYWRk
X2FyZ3VtZW50KCctLXN0YXRzJywgYWN0aW9uPSdzdG9yZV90cnVlJywgaGVscD0n
U2hvdyB0cmFja2luZyBzdGF0aXN0aWNzIGFuZCBleGl0JykNCiAgICBwYXJzZXIu
YWRkX2FyZ3VtZW50KCctLWlnbm9yZS1kdXJhdGlvbicsIHR5cGU9aW50LCBoZWxw
PSdTZXQgaWdub3JlIGR1cmF0aW9uIGluIHNlY29uZHMgKG92ZXJyaWRlcyBlbnZp
cm9ubWVudCB2YXJpYWJsZSknKQ0KICAgIHBhcnNlci5hZGRfYXJndW1lbnQoJy0t
ZW5hYmxlLXRyYWNraW5nJywgYWN0aW9uPSdzdG9yZV90cnVlJywgaGVscD0nRW5h
YmxlIG1lc3NhZ2UgdHJhY2tpbmcgKG92ZXJyaWRlcyBlbnZpcm9ubWVudCB2YXJp
YWJsZSknKQ0KICAgIHBhcnNlci5hZGRfYXJndW1lbnQoJy0tZGlzYWJsZS10cmFj
a2luZycsIGFjdGlvbj0nc3RvcmVfdHJ1ZScsIGhlbHA9J0Rpc2FibGUgbWVzc2Fn
ZSB0cmFja2luZyAob3ZlcnJpZGVzIGVudmlyb25tZW50IHZhcmlhYmxlKScpDQog
ICAgDQogICAgcmV0dXJuIHBhcnNlci5wYXJzZV9hcmdzKCkNCg0KZGVmIHNob3df
dHJhY2tpbmdfc3RhdHMoKToNCiAgICAiIiJEaXNwbGF5IHRyYWNraW5nIHN0YXRp
c3RpY3MgZnJvbSBzYXZlZCBmaWxlcyIiIg0KICAgIHRyeToNCiAgICAgICAgIyBM
b2FkIHRyYWNraW5nIGRhdGENCiAgICAgICAgdHJhY2tpbmdfZmlsZSA9IG9zLnBh
dGguam9pbihvcy5wYXRoLmRpcm5hbWUob3MucGF0aC5hYnNwYXRoKF9fZmlsZV9f
KSksICdtZXNzYWdlX3RyYWNraW5nLmpzb24nKQ0KICAgICAgICBkYWlseV9maWxl
ID0gb3MucGF0aC5qb2luKG9zLnBhdGguZGlybmFtZShvcy5wYXRoLmFic3BhdGgo
X19maWxlX18pKSwgJ2RhaWx5X21lc3NhZ2VzLmpzb24nKQ0KICAgICAgICANCiAg
ICAgICAgcHJpbnQoIj09PSBNZXNzYWdlIFRyYWNraW5nIFN0YXRpc3RpY3MgPT09
IikNCiAgICAgICAgDQogICAgICAgICMgU2hvdyBjb25maWd1cmF0aW9uDQogICAg
ICAgIGlnbm9yZV9kdXJhdGlvbiA9IGludChvcy5lbnZpcm9uLmdldCgnRFVQTElD
QVRFX0lHTk9SRV9EVVJBVElPTicsICczNjAwJykpDQogICAgICAgIHRyYWNraW5n
X2VuYWJsZWQgPSBvcy5lbnZpcm9uLmdldCgnRFVQTElDQVRFX0NIRUNLX0VOQUJM
RUQnLCAndHJ1ZScpLmxvd2VyKCkgPT0gJ3RydWUnDQogICAgICAgIA0KICAgICAg
ICBwcmludChmIlRyYWNraW5nIEVuYWJsZWQ6IHt0cmFja2luZ19lbmFibGVkfSIp
DQogICAgICAgIHByaW50KGYiSWdub3JlIER1cmF0aW9uOiB7aWdub3JlX2R1cmF0
aW9uIC8gMzYwMDouMWZ9IGhvdXJzICh7aWdub3JlX2R1cmF0aW9ufSBzZWNvbmRz
KSIpDQogICAgICAgIA0KICAgICAgICBpZiB0cmFja2luZ19lbmFibGVkIGFuZCBv
cy5wYXRoLmV4aXN0cyh0cmFja2luZ19maWxlKToNCiAgICAgICAgICAgIHdpdGgg
b3Blbih0cmFja2luZ19maWxlLCAncicpIGFzIGY6DQogICAgICAgICAgICAgICAg
dHJhY2tpbmdfZGF0YSA9IGpzb24ubG9hZChmKQ0KICAgICAgICAgICAgDQogICAg
ICAgICAgICBjdXJyZW50X3RpbWUgPSB0aW1lLnRpbWUoKQ0KICAgICAgICAgICAg
Y3V0b2ZmX3RpbWUgPSBjdXJyZW50X3RpbWUgLSBpZ25vcmVfZHVyYXRpb24NCiAg
ICAgICAgICAgIA0KICAgICAgICAgICAgIyBDb3VudCByZWNlbnQgZW50cmllcw0K
ICAgICAgICAgICAgcmVjZW50X2lnbm9yZWQgPSBzdW0oMSBmb3IgZGF0YSBpbiB0
cmFja2luZ19kYXRhLmdldCgnaWdub3JlZCcsIHt9KS52YWx1ZXMoKSANCiAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBkYXRhLmdldCgndGltZXN0YW1w
JywgMCkgPiBjdXRvZmZfdGltZSkNCiAgICAgICAgICAgIHJlY2VudF9jb2xsZWN0
ZWQgPSBzdW0oMSBmb3IgZGF0YSBpbiB0cmFja2luZ19kYXRhLmdldCgnY29sbGVj
dGVkJywge30pLnZhbHVlcygpIA0KICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgaWYgZGF0YS5nZXQoJ3RpbWVzdGFtcCcsIDApID4gY3V0b2ZmX3RpbWUp
DQogICAgICAgICAgICANCiAgICAgICAgICAgIHByaW50KGYiXG5SZWNlbnQgQWN0
aXZpdHkgKGxhc3Qge2lnbm9yZV9kdXJhdGlvbiAvIDM2MDA6LjFmfSBob3Vycyk6
IikNCiAgICAgICAgICAgIHByaW50KGYiICBJZ25vcmVkIE1lc3NhZ2VzOiB7cmVj
ZW50X2lnbm9yZWR9IikNCiAgICAgICAgICAgIHByaW50KGYiICBDb2xsZWN0ZWQg
TWVzc2FnZXM6IHtyZWNlbnRfY29sbGVjdGVkfSIpDQogICAgICAgICAgICANCiAg
ICAgICAgICAgIHByaW50KGYiXG5BbGwgVGltZSBUb3RhbHM6IikNCiAgICAgICAg
ICAgIHByaW50KGYiICBUb3RhbCBJZ25vcmVkOiB7bGVuKHRyYWNraW5nX2RhdGEu
Z2V0KCdpZ25vcmVkJywge30pKX0iKQ0KICAgICAgICAgICAgcHJpbnQoZiIgIFRv
dGFsIENvbGxlY3RlZDoge2xlbih0cmFja2luZ19kYXRhLmdldCgnY29sbGVjdGVk
Jywge30pKX0iKQ0KICAgICAgICAgICAgDQogICAgICAgICAgICAjIFNob3cgc29t
ZSByZWNlbnQgaWdub3JlZCBtZXNzYWdlcw0KICAgICAgICAgICAgaWYgdHJhY2tp
bmdfZGF0YS5nZXQoJ2lnbm9yZWQnKToNCiAgICAgICAgICAgICAgICBwcmludChm
IlxuUmVjZW50IElnbm9yZWQgTWVzc2FnZXM6IikNCiAgICAgICAgICAgICAgICBz
b3J0ZWRfaWdub3JlZCA9IHNvcnRlZCh0cmFja2luZ19kYXRhWydpZ25vcmVkJ10u
aXRlbXMoKSwgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IGtleT1sYW1iZGEgeDogeFsxXS5nZXQoJ3RpbWVzdGFtcCcsIDApLCByZXZlcnNl
PVRydWUpDQogICAgICAgICAgICAgICAgZm9yIHVzZXJfaWQsIGRhdGEgaW4gc29y
dGVkX2lnbm9yZWRbOjVdOiAgIyBTaG93IGxhc3QgNQ0KICAgICAgICAgICAgICAg
ICAgICBpZiBkYXRhLmdldCgndGltZXN0YW1wJywgMCkgPiBjdXRvZmZfdGltZToN
CiAgICAgICAgICAgICAgICAgICAgICAgIHByaW50KGYiICB7ZGF0YS5nZXQoJ25h
bWUnLCAnVW5rbm93bicpfSAoSUQ6IHt1c2VyX2lkfSkgLSB7ZGF0YS5nZXQoJ3Jl
YXNvbicsICdObyByZWFzb24nKX0gLSB7ZGF0YS5nZXQoJ3RpbWVfZm9ybWF0dGVk
JywgJ1Vua25vd24gdGltZScpfSIpDQogICAgICAgICAgICANCiAgICAgICAgICAg
ICMgU2hvdyBzb21lIHJlY2VudCBjb2xsZWN0ZWQgbWVzc2FnZXMNCiAgICAgICAg
ICAgIGlmIHRyYWNraW5nX2RhdGEuZ2V0KCdjb2xsZWN0ZWQnKToNCiAgICAgICAg
ICAgICAgICBwcmludChmIlxuUmVjZW50IENvbGxlY3RlZCBNZXNzYWdlczoiKQ0K
ICAgICAgICAgICAgICAgIHNvcnRlZF9jb2xsZWN0ZWQgPSBzb3J0ZWQodHJhY2tp
bmdfZGF0YVsnY29sbGVjdGVkJ10uaXRlbXMoKSwgDQogICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAga2V5PWxhbWJkYSB4OiB4WzFdLmdldCgn
dGltZXN0YW1wJywgMCksIHJldmVyc2U9VHJ1ZSkNCiAgICAgICAgICAgICAgICBm
b3IgdXNlcl9pZCwgZGF0YSBpbiBzb3J0ZWRfY29sbGVjdGVkWzo1XTogICMgU2hv
dyBsYXN0IDUNCiAgICAgICAgICAgICAgICAgICAgaWYgZGF0YS5nZXQoJ3RpbWVz
dGFtcCcsIDApID4gY3V0b2ZmX3RpbWU6DQogICAgICAgICAgICAgICAgICAgICAg
ICBwcmludChmIiAge2RhdGEuZ2V0KCduYW1lJywgJ1Vua25vd24nKX0gKElEOiB7
dXNlcl9pZH0pIC0ge2RhdGEuZ2V0KCd0aW1lX2Zvcm1hdHRlZCcsICdVbmtub3du
IHRpbWUnKX0iKQ0KICAgICAgICANCiAgICAgICAgIyBTaG93IGRhaWx5IHN0YXRz
DQogICAgICAgIGlmIG9zLnBhdGguZXhpc3RzKGRhaWx5X2ZpbGUpOg0KICAgICAg
ICAgICAgd2l0aCBvcGVuKGRhaWx5X2ZpbGUsICdyJykgYXMgZjoNCiAgICAgICAg
ICAgICAgICBkYWlseV9kYXRhID0ganNvbi5sb2FkKGYpDQogICAgICAgICAgICAN
CiAgICAgICAgICAgIHByaW50KGYiXG5EYWlseSBGb3J3YXJkaW5nIFN0YXRzOiIp
DQogICAgICAgICAgICBwcmludChmIiAgRGF0ZToge2RhaWx5X2RhdGEuZ2V0KCdk
YXRlJywgJ1Vua25vd24nKX0iKQ0KICAgICAgICAgICAgcHJpbnQoZiIgIFVzZXJz
IEZvcndhcmRlZCBUb2RheToge2xlbihkYWlseV9kYXRhLmdldCgnZm9yd2FyZGVk
X3VzZXJzJywge30pKX0iKQ0KICAgICAgICAgICAgDQogICAgICAgICAgICBpZiBk
YWlseV9kYXRhLmdldCgnZm9yd2FyZGVkX3VzZXJzJyk6DQogICAgICAgICAgICAg
ICAgcHJpbnQoZiIgIFJlY2VudCBGb3J3YXJkZWQgVXNlcnM6IikNCiAgICAgICAg
ICAgICAgICBmb3IgdXNlcl9pZCwgZGF0YSBpbiBsaXN0KGRhaWx5X2RhdGFbJ2Zv
cndhcmRlZF91c2VycyddLml0ZW1zKCkpWzo1XTogICMgU2hvdyBsYXN0IDUNCiAg
ICAgICAgICAgICAgICAgICAgcHJpbnQoZiIgICAge2RhdGEuZ2V0KCduYW1lJywg
J1Vua25vd24nKX0gKElEOiB7dXNlcl9pZH0pIC0ge2RhdGEuZ2V0KCd0aW1lJywg
J1Vua25vd24gdGltZScpfSIpDQogICAgICAgIA0KICAgICAgICBwcmludCgiPT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSIpDQogICAgICAgIA0KICAg
IGV4Y2VwdCBFeGNlcHRpb24gYXMgZToNCiAgICAgICAgcHJpbnQoZiJFcnJvciBy
ZWFkaW5nIHRyYWNraW5nIHN0YXRpc3RpY3M6IHtlfSIpDQoNCmFzeW5jIGRlZiBt
YWluKCk6DQogICAgIiIiTWFpbiBmdW5jdGlvbiB0byBydW4gdGhlIHVzZXJib3Qi
IiINCiAgICAjIFBhcnNlIGNvbW1hbmQgbGluZSBhcmd1bWVudHMNCiAgICBhcmdz
ID0gcGFyc2VfYXJndW1lbnRzKCkNCiAgICANCiAgICAjIE92ZXJyaWRlIGVudmly
b25tZW50IHZhcmlhYmxlcyB3aXRoIGNvbW1hbmQgbGluZSBhcmd1bWVudHMNCiAg
ICBnbG9iYWwgRFVQTElDQVRFX0lHTk9SRV9EVVJBVElPTiwgRFVQTElDQVRFX0NI
RUNLX0VOQUJMRUQNCiAgICANCiAgICBpZiBhcmdzLmlnbm9yZV9kdXJhdGlvbiBp
cyBub3QgTm9uZToNCiAgICAgICAgRFVQTElDQVRFX0lHTk9SRV9EVVJBVElPTiA9
IGFyZ3MuaWdub3JlX2R1cmF0aW9uDQogICAgICAgIGxvZ2dlci5pbmZvKGYiT3Zl
cnJpZGU6IElnbm9yZSBkdXJhdGlvbiBzZXQgdG8ge0RVUExJQ0FURV9JR05PUkVf
RFVSQVRJT059IHNlY29uZHMgKHtEVVBMSUNBVEVfSUdOT1JFX0RVUkFUSU9OIC8g
MzYwMDouMWZ9IGhvdXJzKSIpDQogICAgDQogICAgaWYgYXJncy5lbmFibGVfdHJh
Y2tpbmc6DQogICAgICAgIERVUExJQ0FURV9DSEVDS19FTkFCTEVEID0gVHJ1ZQ0K
ICAgICAgICBsb2dnZXIuaW5mbygiT3ZlcnJpZGU6IE1lc3NhZ2UgdHJhY2tpbmcg
ZW5hYmxlZCIpDQogICAgZWxpZiBhcmdzLmRpc2FibGVfdHJhY2tpbmc6DQogICAg
ICAgIERVUExJQ0FURV9DSEVDS19FTkFCTEVEID0gRmFsc2UNCiAgICAgICAgbG9n
Z2VyLmluZm8oIk92ZXJyaWRlOiBNZXNzYWdlIHRyYWNraW5nIGRpc2FibGVkIikN
CiAgICANCiAgICAjIFZhbGlkYXRlIGVudmlyb25tZW50IHZhcmlhYmxlcw0KICAg
IGlmIG5vdCBBUElfSUQgb3Igbm90IEFQSV9IQVNIOg0KICAgICAgICBsb2dnZXIu
ZXJyb3IoIkVycm9yOiBBUEkgY3JlZGVudGlhbHMgbm90IHNldC4gUGxlYXNlIHNl
dCBURUxFR1JBTV9BUElfSUQgYW5kIFRFTEVHUkFNX0FQSV9IQVNILiIpDQogICAg
ICAgIHJldHVybiAxDQogICAgICAgIA0KICAgIGlmIG5vdCBCT1RfVVNFUk5BTUU6
DQogICAgICAgIGxvZ2dlci5lcnJvcigiRXJyb3I6IEJvdCB1c2VybmFtZSBub3Qg
c2V0LiBQbGVhc2Ugc2V0IFRFTEVHUkFNX0JPVF9VU0VSTkFNRS4iKQ0KICAgICAg
ICByZXR1cm4gMQ0KICAgIA0KICAgIGxvZ2dlci5pbmZvKGYiU3RhcnRpbmcgdXNl
cmJvdCB3aXRoIEFQSV9JRDoge0FQSV9JRH0iKQ0KICAgIGxvZ2dlci5pbmZvKGYi
Qm90IHVzZXJuYW1lOiB7Qk9UX1VTRVJOQU1FfSIpDQogICAgbG9nZ2VyLmluZm8o
ZiJTZXNzaW9uIHBhdGg6IHtTRVNTSU9OX1BBVEh9IikNCiAgICANCiAgICAjIFNl
dHVwIHNpZ25hbCBoYW5kbGVycyBmb3IgZ3JhY2VmdWwgc2h1dGRvd24NCiAgICBz
aWduYWwuc2lnbmFsKHNpZ25hbC5TSUdJTlQsIHNpZ25hbF9oYW5kbGVyKQ0KICAg
IHNpZ25hbC5zaWduYWwoc2lnbmFsLlNJR1RFUk0sIHNpZ25hbF9oYW5kbGVyKQ0K
ICAgIA0KICAgICMgQ3JlYXRlIGFuZCBydW4gdGhlIGZvcndhcmRlcg0KICAgIGZv
cndhcmRlciA9IFVzZXJib3RGb3J3YXJkZXIoKQ0KICAgIA0KICAgIHRyeToNCiAg
ICAgICAgYXdhaXQgZm9yd2FyZGVyLnJ1bl93aXRoX3JldHJ5KCkNCiAgICAgICAg
cmV0dXJuIDANCiAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6DQogICAgICAgIGxv
Z2dlci5lcnJvcihmIkZhdGFsIGVycm9yOiB7ZX0iKQ0KICAgICAgICByZXR1cm4g
MQ0KDQppZiBfX25hbWVfXyA9PSAnX19tYWluX18nOg0KICAgIGFyZ3MgPSBwYXJz
ZV9hcmd1bWVudHMoKQ0KICAgIA0KICAgIGlmIGFyZ3Muc3RhdHM6DQogICAgICAg
IHNob3dfdHJhY2tpbmdfc3RhdHMoKQ0KICAgIGVsc2U6DQogICAgICAgIHRyeToN
CiAgICAgICAgICAgIGV4aXRfY29kZSA9IGFzeW5jaW8ucnVuKG1haW4oKSkNCiAg
ICAgICAgICAgIHN5cy5leGl0KGV4aXRfY29kZSkNCiAgICAgICAgZXhjZXB0IEtl
eWJvYXJkSW50ZXJydXB0Og0KICAgICAgICAgICAgbG9nZ2VyLmluZm8oZiJBcHBs
aWNhdGlvbiBpbnRlcnJ1cHRlZCBieSB1c2VyIikNCiAgICAgICAgICAgIHN5cy5l
eGl0KDApDQogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToNCiAgICAgICAg
ICAgIGxvZ2dlci5lcnJvcihmIkZhdGFsIGVycm9yIGluIG1haW46IHtlfSIpDQog
ICAgICAgICAgICBzeXMuZXhpdCgxKQ==
-----END CERTIFICATE-----
